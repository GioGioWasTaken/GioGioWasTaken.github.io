<!doctype html><html data-theme=dark lang=en xmlns=http://www.w3.org/1999/xhtml><head><meta charset=UTF-8><meta name=description><meta content="width=device-width,initial-scale=1" name=viewport><meta content=#9ac2c2 name=theme-color><title>Srop - Gio's site</title><link href=https://giogiowastaken.github.io/Cybersecurity/srop/ rel=canonical><link href=https://giogiowastaken.github.io/favicon.png rel=icon type=image/png><link href=https://giogiowastaken.github.io/apple-touch-icon.png rel=apple-touch-icon sizes=180x180 type=image/png><style>:root{--accent-color:#9ac2c2}</style><link href=https://giogiowastaken.github.io/style.css rel=stylesheet><script defer src=https://giogiowastaken.github.io/closable.js></script><meta content="Gio's site" property=og:site_name><meta content="Srop - Gio's site" property=og:title><meta content=https://giogiowastaken.github.io/Cybersecurity/srop/ property=og:url><meta property=og:description><meta content=https://giogiowastaken.github.io/card.png property=og:image><meta content=en_US property=og:locale><body><main id=main-content><h1>Srop</h1><h1 id=sigreturn-oriented-programming>Sigreturn-oriented programming</h1><p>When a program is running and a signal occurs, the kernel pauses the process execution in order to jump to a signal handler routine. An example of this could be a user keyboard interrupt which triggers a SigKill.<p>So that execution may be resumed safely after the handler completes, the context of that process is pushed onto the stack. When the handler is finished, a sigreturn() is called which will restore the context of the process by popping the values from the stack.<p><a href=https://www.youtube.com/watch?vd0gS5TXarXc>this</a> youtube video explains signals.<h1 id=trigger-conditions>Trigger conditions</h1><p>We need to use some gadgets in order to trigger the signal. Essentially we need to make a syscall whilst the rt_sigreturn syscall number is in the rax register.<h2 id=x64>x64</h2><p>mov rax, 0x0f; syscall; ret<h2 id=x86>x86</h2><p>mov eax, 0x77; int 0x80; ret</main><footer id=site-footer></footer>