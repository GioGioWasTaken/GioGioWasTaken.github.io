<!doctype html><html data-theme=dark lang=en xmlns=http://www.w3.org/1999/xhtml><head><meta charset=UTF-8><meta name=description><meta content="width=device-width,initial-scale=1" name=viewport><meta content=#9ac2c2 name=theme-color><title>Ret2Csu - Gio's site</title><link href=https://giogiowastaken.github.io/Cybersecurity/ret2csu/ rel=canonical><link href=https://giogiowastaken.github.io/favicon.png rel=icon type=image/png><link href=https://giogiowastaken.github.io/apple-touch-icon.png rel=apple-touch-icon sizes=180x180 type=image/png><style>:root{--accent-color:#9ac2c2}</style><link href=https://giogiowastaken.github.io/style.css rel=stylesheet><script defer src=https://giogiowastaken.github.io/closable.js></script><meta content="Gio's site" property=og:site_name><meta content="Ret2Csu - Gio's site" property=og:title><meta content=https://giogiowastaken.github.io/Cybersecurity/ret2csu/ property=og:url><meta property=og:description><meta content=https://giogiowastaken.github.io/card.png property=og:image><meta content=en_US property=og:locale><body><main id=main-content><h1>Ret2Csu</h1><h1 id=ret2csu>Ret2CSU</h1><p>Dynamically linked binaries need to have some code stored on them in order for the dynmic linking process to be even viable. In certain cases, where the amount of gadgets available for use is scarce, it might be wise to turn to these functions, for more gadgets.<p>CSU stands for C Startup. It refers to the set of object files and source code that handle the initialization of a C program before the main function is called. This includes: - Setting up the runtime environment (the stack, for example.) - Initializing global variables. - Calling constructors of C++ objects (if present). - Finally, invoking the main function.<p>These functions contain within them a selection of gadgets that we can use to populate registers we lack gadgets for, most importantly <code>__libc_csu_init</code>, which contains the following two gadgets:<p><code>0x004011a2      5b             pop rbx 0x004011a3      5d             pop rbp 0x004011a4      415c           pop r12 0x004011a6      415d           pop r13 0x004011a8      415e           pop r14 0x004011aa      415f           pop r15 0x004011ac      c3             ret</code><p><code>0x00401188      4c89f2         mov rdx, r14                ; char **ubp_av 0x0040118b      4c89ee         mov rsi, r13                ; int argc 0x0040118e      4489e7         mov edi, r12d               ; func main 0x00401191      41ff14df       call qword [r15 + rbx*8]</code></main><footer id=site-footer></footer>